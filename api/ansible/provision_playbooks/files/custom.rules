# DNS exfiltration rules
alert dns $HOME_NET any -> any 53 (msg:"DNS Exfiltration - FQDN too long"; dns.query; pcre:"/^.{150,}$/"; classtype:dns-exfiltration; sid:1000002; rev:1;)
alert dns $HOME_NET any -> any 53 (msg:"Possible DNS Exfiltration - High Entropy Query"; dns.query; pcre:"/^(?:[A-Za-z0-9-]{20,}\.)+[A-Za-z0-9-]+(?:\.[A-Za-z0-9-]+)+$/"; classtype:dns-exfiltration; sid:1000003; rev:1;)

# C2 connection rules
alert ip any any -> $C2_SERVER any (msg:"Traffic to known C2 IP"; classtype:c2-traffic; sid:1000005; rev:1;)

# NMAP
alert tcp any any -> any any (msg:"SYN Scan Detected"; classtype:network-syn-scan; flags:S; threshold:type both, track by_src, count 100, seconds 5; sid:1000006; rev:1;)
